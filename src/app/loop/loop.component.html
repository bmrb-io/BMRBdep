<div *ngIf="(showInvalidOnly && !loop.valid) || !showInvalidOnly">
	<table class="loop">
   		<colgroup>
	      <col span="1" style="width: 2.5em;">
	   </colgroup>
		<thead>
			<tr (contextmenu)="log()">
			  <th colspan=999>
          {{loop.data[0][0].schemaValues['ADIT category view name']}}
          <a *ngIf="loop.category == '_Citation_author' && loop.empty" class="fake_button line" (click)="copyAuthors()">Copy authors from 'Entry information'</a>
        </th>
			</tr>
			<tr>
        <th style="border-collapse: collapse;"></th>
        <ng-container *ngFor='let col of loop.tags; let c = index'>
          <th *ngIf="loop.data[0][c].display == 'Y' || (loop.data[0][c].display == 'N' && showAll)"
              class="tag_header"
                (click)="activeTag = (activeTag != loop.data[0][c] ? loop.data[0][c] : null)"
                [title]="loop.data[0][c].schemaValues['Interface']"
                >{{loop.data[0][c].schemaValues['Prompt']}}
            <span *ngIf="loop.data[0][c].display == 'Y'" class="mandatory">*</span>
          </th>
          </ng-container>
			</tr>
		</thead>
		<tbody>
			<tr *ngFor="let row of loop.data; let r = index">
			<td><button *ngIf="r>0" class="real_button" (click)='deleteRow(r)'>-</button></td>
			<ng-container *ngFor="let col of row; let c = index">
			  <td *ngIf="loop.data[r][c].display == 'Y' || (loop.data[r][c].display == 'N' && showAll)"
	      		  [ngClass]="{'invisible': true, 'invalid': !loop.data[r][c].valid}">
			    <app-tag [tag]='loop.data[r][c]'
                   [unique_identifier]="'_' + loop.parent.name + '_' + r + '_' + c"
                   (contextmenu)="loop.data[r][c].log()"></app-tag>
			  </td>
			  </ng-container>
			</tr>
			<tr>
				<td colspan=999>
				  <button class="real_button" (click)='addRow()'>+</button>
				</td>
			</tr>

		</tbody>
	</table>


	<div *ngIf='activeTag' class='tag_info_box'>
      <b>{{activeTag.schemaValues['Prompt']}}</b>
      <p>{{activeTag.schemaValues['Interface']}}</p>
      <p *ngIf="activeTag.schemaValues['Example'] != '?'"><b>Example:</b> {{activeTag.schemaValues['Example']}}</p>
      <p><i>{{activeTag.fullyQualifiedTagName}}</i></p>
      <p *ngIf="activeTag.validationMessage" [class]="'mandatory'">{{activeTag.validationMessage}}</p>
    </div>
</div>
