<app-file-uploader *ngIf="saveframe.category == 'deposited_data_files'; else normal" [entry]="saveframe.parent"></app-file-uploader>
<ng-template #normal>
  <div *ngIf="saveframe.display == 'Y' || (showAll && saveframe.display == 'N')">

    <table style="width: 100%">
      <colgroup>
           <col span="1" style="width: 20%;">
           <col span="1" style="width: 70%;">
        </colgroup>

      <thead>
        <tr>
          <th *ngIf="saveframe.tags[0]" (contextmenu)="saveframe.log()">
          <a class="header_text" [title]="saveframe.schemaValues['group_view_help']">
            {{saveframe.schemaValues['category_group_view_name']}}
          </a>
          </th>
          <th>
            <div style="text-align: right; float: right">
              <a class="fake_button line"
                *ngIf="saveframe.schemaValues['ADIT replicable'] === 'Y'"
                (click)='saveframe.duplicate(); processChange()'>Duplicate</a>
            <a class="fake_button line"
              *ngIf="saveframe.schemaValues['ADIT replicable'] === 'Y'"
              (click)='saveframe.duplicate(true); processChange()'>Create New</a>
            <a class="fake_button line"
              *ngIf="saveframe.index >= saveframe.schemaValues['mandatory_number']"
              (click)='saveframe.parent.removeSaveframe(saveframe); processChange()'>Delete</a>
            <a class="fake_button line"
              *ngIf="showCategoryLink"
              [routerLink]="['/entry', saveframe.parent.entryID, 'saveframe', saveframe.category, 'category']">View sections of this category</a>
            </div>
          </th>
        </tr>
      </thead>
      <tbody>
      <ng-container *ngFor="let sftag of saveframe.tags">
            <tr *ngIf="sftag.display == 'Y' || (showAll && sftag.display == 'N')"
              (contextmenu)="sftag.log()">
              <td [ngClass]="{'mandatory': sftag.display == 'Y', 'tag_description': true}"
              [innerHTML]="sftag.schemaValues['Prompt']"
              [title]="sftag.schemaValues['Interface']"
              (click)="activeTag = (active_tag != sftag ? sftag : null)">
          </td>
          <td [ngClass]="{'invisible': true, 'invalid': !sftag.valid}">
                <app-tag [tag]='sftag' [unique_identifier]="'_' + saveframe.name" ></app-tag>
              </td>
        </tr>
      </ng-container>
      </tbody>
    </table>

    <div *ngIf='active_tag' class='tag_info_box'>
      <b>{{active_tag.schemaValues['Prompt']}}</b>
      <p>{{active_tag.schemaValues['Interface']}}</p>
      <p *ngIf="active_tag.schemaValues['Example'] != '?'"><b>Example:</b> {{active_tag.schemaValues['Example']}}</p>
      <p><i>{{active_tag.fullyQualifiedTagName}}</i></p>
      <p *ngIf='active_tag.validationMessage' [class]="'mandatory'">{{active_tag.validationMessage}}</p>
    </div>

    <ng-container *ngFor='let loop of saveframe.loops'>
      <app-loop *ngIf="loop.display == 'Y' || (loop.display == 'N' && showAll)" [loop]='loop' [showAll]="showAll"></app-loop>
    </ng-container>
  </div>
</ng-template>
